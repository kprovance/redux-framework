(function(b){b.reduxTypography=b.reduxTypography||{};var c=[];var a=false;b(document).ready(function(){b.reduxTypography.init()});b.reduxTypography.init=function(){b(".redux-typography-container").each(function(){var e=b(this).find(".redux-typography-family");if(e.data("value")!==""){b(e).val(e.data("value"))}b.reduxTypography.select(e);window.onbeforeunload=null});b(".redux-typography").on("change",function(){b.reduxTypography.select(b(this))});b(".redux-typography-size, .redux-typography-height, .redux-typography-word, .redux-typography-letter, .redux-typography-align, .redux-typography-transform, .redux-typography-font-variant, .redux-typography-decoration").keyup(function(){b.reduxTypography.select(b(this))});b(".redux-typography-color").wpColorPicker({change:function(e,f){redux_change(b(this));b(this).val(f.color.toString());b.reduxTypography.select(b(this))}});b(".redux-typography-size").numeric({allowMinus:false,});b(".redux-typography-height, .redux-typography-word, .redux-typography-letter").numeric({allowMinus:true,});var d=[{id:"none",text:"none"}];b(".redux-typography-family").select2({matcher:function(e,f){return f.toUpperCase().indexOf(e.toUpperCase())==0},query:function(e){return window.Select2.query.local(d)(e)},initSelection:function(e,g){var f={id:e.val(),text:e.val()};g(f)},}).on("select2-opening",function(l){var o=b(this).parents(".redux-container-typography:first").attr("data-id");var h=b("#"+o+" .redux-typography-font-family").data("user-fonts");h=h?1:0;var i=b("#"+o+" .redux-typography-google").val();i=i?1:0;var m=[];if(redux.customfonts!=undefined){m.push(redux.customfonts)}if(redux.stdfonts!=undefined&&h==0){m.push(redux.stdfonts)}if(h==1){var g=[];for(var p in redux.typography[o]){var k=redux.typography[o].std_font;for(var f in k){if(k.hasOwnProperty(f)){g.push({id:f,text:f,"data-google":"false"})}}}var j={text:"Standard Fonts",children:g};m.push(j)}if(i==1||i===true&&redux.googlefonts!=undefined){m.push(redux.googlefonts)}d=m;var n=b("#"+o+" select.redux-typography-family").val();if(!n){n=null}b(".redux-typography-family").select2("val",n)}).on("select2-selecting",function(f,e){c=f;a=true});b(" .redux-typography-family-backup, .redux-typography-align, .redux-typography-transform, .redux-typography-font-variant, .redux-typography-decoration").select2({width:"resolve",triggerChange:true,allowClear:true})};b.reduxTypography.size=function(f){var e=0,d;for(d in f){if(f.hasOwnProperty(d)){e++}}return e};b.reduxTypography.makeBool=function(d){if(d=="false"||d=="0"||d===false||d==0){return false}else{if(d=="true"||d=="1"||d===true||d==1){return true}}};b.reduxTypography.select=function(u){var d=b(u).parents(".redux-container-typography:first").attr("data-id");var z=b("#"+d+" div.redux-typography-family").val();if(!z){z=null}var e=b("#"+d+" select.redux-typography-family-backup").val();var o=b("#"+d+" .redux-typography-size").val();var p=b("#"+d+" .redux-typography-height").val();var x=b("#"+d+" .redux-typography-word").val();var B=b("#"+d+" .redux-typography-letter").val();var t=b("#"+d+" select.redux-typography-align").val();var n=b("#"+d+" select.redux-typography-transform").val();var h=b("#"+d+" select.redux-typography-font-variant").val();var k=b("#"+d+" select.redux-typography-decoration").val();var w=b("#"+d+" select.redux-typography-style").val();var A=b("#"+d+" select.redux-typography-subsets").val();var s=b("#"+d+" .redux-typography-color").val();var r=b("#"+d).data("units");var j=z;if(a==true){var f=b.reduxTypography.makeBool(c.object["data-google"]);b("#"+d+" .redux-typography-google-font").val(f)}else{var f=b.reduxTypography.makeBool(b("#"+d+" .redux-typography-google-font").val())}if(!b("#"+d).hasClass("typography-initialized")){w=b("#"+d+" select.redux-typography-style").data("value");A=b("#"+d+" select.redux-typography-subsets").data("value");if(w!==""){w=String(w)}if(typeof(A)!==undefined){A=String(A)}}var y="";if(redux.fonts.google===undefined){f=false}if(f===true&&(z in redux.fonts.google)){y=redux.fonts.google[z]}else{y={"400":"Normal 400","700":"Bold 700","400italic":"Normal 400 Italic","700italic":"Bold 700 Italic"}}if(b(u).hasClass("redux-typography-family")){var m='<option value=""></option>';if(f===true){var q="";b.each(y.variants,function(C,D){if(D.id===w||b.reduxTypography.size(y.variants)===1){q=' selected="selected"';w=D.id}else{q=""}m+='<option value="'+D.id+'"'+q+">"+D.name.replace(/\+/g," ")+"</option>"});b(".redux-typography-style").select2("destroy");b("#"+d+" .redux-typography-style").html(m);b("#"+d+" .redux-typography-style").select2({width:"resolve",triggerChange:true,allowClear:true});q="";m='<option value=""></option>';b.each(y.subsets,function(C,D){if(D.id===A||b.reduxTypography.size(y.subsets)===1){q=' selected="selected"';A=D.id}else{q=""}m+='<option value="'+D.id+'"'+q+">"+D.name.replace(/\+/g," ")+"</option>"});if(typeof(e)!=="undefined"&&e!==""){j+=", "+e}b(".redux-typography-subsets").select2("destroy");b("#"+d+" .redux-typography-subsets").html(m);b("#"+d+" .redux-typography-subsets").select2({width:"resolve",triggerChange:true,allowClear:true});b("#"+d+" .redux-typography-subsets").parent().fadeIn("fast");b("#"+d+" .typography-family-backup").fadeIn("fast")}else{if(y){b.each(y,function(C,D){if(C===w||C==="normal"){q=' selected="selected"';b("#"+d+" .typography-style .select2-chosen").text(D)}else{q=""}m+='<option value="'+C+'"'+q+">"+D.replace("+"," ")+"</option>"});b(".redux-typography-style").select2("destroy");b("#"+d+" .redux-typography-style").html(m);b("#"+d+" .redux-typography-style").select2({width:"resolve",triggerChange:true,allowClear:true});b("#"+d+" .redux-typography-subsets").parent().fadeOut("fast");b("#"+d+" .typography-family-backup").fadeOut("fast")}}}else{if(b(u).hasClass("redux-typography-family-backup")&&e!==""){b("#"+d+" .redux-typography-font-family").val(j)}}if(b("#"+d+" select.redux-typography-style option[value='"+w+"']").length===0){w="";b("#"+d+" select.redux-typography-style").select2("val","")}else{if(w==="400"){b("#"+d+" select.redux-typography-style").select2("val",w)}}if(b("#"+d+" select.redux-typography-subsets option[value='"+A+"']").length===0){A="";b("#"+d+" select.redux-typography-subsets").select2("val","")}var v="style_link_"+d;b("."+v).remove();if(z!==null&&z!=="inherit"&&b("#"+d).hasClass("typography-initialized")){var g=z.replace(/\s+/g,"+");if(f===true){var i=g;if(w){i+=":"+w.replace(/\-/g," ")}if(A){i+="&subset="+A}if(typeof(WebFont)!=="undefined"&&WebFont){WebFont.load({google:{families:[i]}})}b("#"+d+" .redux-typography-google").val(true)}else{b("#"+d+" .redux-typography-google").val(false)}}if(w.indexOf("italic")!==-1){b("#"+d+" .typography-preview").css("font-style","italic");b("#"+d+" .typography-font-style").val("italic");w=w.replace("italic","")}else{b("#"+d+" .typography-preview").css("font-style","normal")}b("#"+d+" .typography-font-weight").val(w);if(!p){p=o}if(o===""){b("#"+d+" .typography-font-size").val("")}else{b("#"+d+" .typography-font-size").val(o+r)}if(p===""){b("#"+d+" .typography-line-height").val("")}else{b("#"+d+" .typography-line-height").val(p+r)}b("#"+d+" .typography-word-spacing").val(x+r);b("#"+d+" .typography-letter-spacing").val(B+r);if(b("#"+d).hasClass("typography-initialized")){var l=b("#"+d+" .typography-preview").data("preview-size");if(l=="0"){b("#"+d+" .typography-preview").css("font-size",o+r)}b("#"+d+" .typography-preview").css("font-weight",w);b("#"+d+" .typography-preview").css("font-family",z+", sans-serif");if(z==="none"&&z===""){b("#"+d+" .typography-preview").css("font-family","inherit")}b("#"+d+" .typography-preview").css("line-height",p+r);b("#"+d+" .typography-preview").css("word-spacing",x+r);b("#"+d+" .typography-preview").css("letter-spacing",B+r);if(s){b("#"+d+" .typography-preview").css("color",s);b("#"+d+" .typography-preview").css("background-color",getContrastColour(s))}b("#"+d+" .redux-typography-font-family").val(j);b("#"+d+" .typography-style .select2-chosen").text(b("#"+d+" .redux-typography-style option:selected").text());b("#"+d+" .typography-script .select2-chosen").text(b("#"+d+" .redux-typography-subsets option:selected").text());if(t){b("#"+d+" .typography-preview").css("text-align",t)}if(n){b("#"+d+" .typography-preview").css("text-transform",n)}if(h){b("#"+d+" .typography-preview").css("font-variant",h)}if(k){b("#"+d+" .typography-preview").css("text-decoration",k)}b("#"+d+" .typography-preview").slideDown()}if(!b("#"+d).hasClass("typography-initialized")){b("#"+d).addClass("typography-initialized")}a=false}})(jQuery);
